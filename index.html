<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Tarifa de Aluguel</title>
</head>
<body>
    <h1>Calculadora de Tarifa de Aluguel</h1>
    <form id="rentalForm">
        <label for="numPeople">Número de Pessoas:</label>
        <input type="number" id="numPeople" min="1" required><br>

        <label for="startDate">Data de Início:</label>
        <input type="date" id="startDate" required><br>

        <label for="endDate">Data de Fim:</label>
        <input type="date" id="endDate" required><br>

        <button type="submit">Calcular Tarifa</button>
    </form>

    <p id="result"></p>

    <!-- Adiciona a área para as frases -->
    <p id="additionalInfo" style="display: none;">
        Clique <a href="https://drive.google.com/drive/u/0/folders/11FJ-7dSZk2I5ddcfFFiKgIsQzIxFGRbj" target="_blank">aqui para fazer download de fotos e descrição completa dos espaços</a>.<br><br>
        Quer agendar uma visita ou confirmar reserva? Mande mensagem no <a href="https://api.whatsapp.com/send?phone=SEU_NUMERO_DE_WHATSAPP&text=Informações da reserva: " target="_blank">WhatsApp</a>, com as informações fornecidas acima.
    </p>

    <script>
        // Carregar o arquivo JSON das tarifas
        let rentalRates;

        fetch('tarifas.json')
            .then(response => response.json())
            .then(data => {
                rentalRates = data;
            })
            .catch(error => {
                console.error('Erro ao carregar o arquivo JSON:', error);
            });

        function formatDate(date) {
            const d = new Date(date);
            let day = '' + d.getDate();
            let month = '' + (d.getMonth() + 1);
            const year = d.getFullYear();

            if (day.length < 2) day = '0' + day;
            if (month.length < 2) month = '0' + month;
            return [year, month, day].join('-');
        }

        document.getElementById('rentalForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const numPeople = parseInt(document.getElementById('numPeople').value);
            const startDate = new Date(document.getElementById('startDate').value);
            const endDate = new Date(document.getElementById('endDate').value);

            if (startDate > endDate) {
                document.getElementById('result').innerText = "A data de fim deve ser maior que a data de início.";
                return;
            }

            let totalCost = 0;
            let currentDate = new Date(startDate);

            while (currentDate <= endDate) {
                const formattedDate = formatDate(currentDate);
                const dayRate = rentalRates.find(rate => rate.Data.split('T')[0] === formattedDate);

                if (!dayRate) {
                    document.getElementById('result').innerText = `Não há tarifas disponíveis para a data ${formattedDate}.`;
                    return;
                }

                let rate;
                let additionalRate = 0;

                // Verificar a faixa correta de tarifa baseada no número de pessoas
                if (numPeople <= 20) {
                    rate = dayRate['Até 20 pessoas'];
                } else if (numPeople <= 30) {
                    rate = dayRate['21 a 30 pessoas'];
                } else if (numPeople <= 40) {
                    rate = dayRate['31 a 40 pessoas'];
                } else {
                    // Caso tenha mais de 40 pessoas, calcular para as primeiras 40 e adicionar o adicional
                    rate = dayRate['31 a 40 pessoas']; // Para as 40 primeiras pessoas
                    
                    // Verifica se o campo "Adicional" existe antes de usar
                    if (dayRate['Adicional'] !== undefined) {
                        additionalRate = dayRate['Adicional'] * (numPeople - 40); // Para as pessoas adicionais
                    } else {
                        additionalRate = 0; // Se o valor adicional não estiver presente
                    }
                }

                // Multiplicar a tarifa base pela quantidade de pessoas (para até 40)
                totalCost += rate * Math.min(numPeople, 40); 
                // Adicionar o custo adicional para pessoas extras (acima de 40)
                totalCost += additionalRate;

                currentDate.setDate(currentDate.getDate() + 1);
            }

            // Garantir que o valor mínimo seja de R$1500
            if (totalCost < 1500) {
                totalCost = 1500;
            }

            document.getElementById('result').innerText = `O valor total da estadia é R$ ${totalCost.toFixed(2)}`;

            // Exibe as frases adicionais
            document.getElementById('additionalInfo').style.display = 'block';
        });
    </script>
</body>
</html>

