<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Tarifa de Aluguel</title>
</head>
<body>
    <h1>Calculadora de Tarifa de Aluguel</h1>
    <form id="rentalForm">
        <label for="numPeople">Número de Pessoas:</label>
        <input type="number" id="numPeople" min="1" required><br>

        <label for="startDate">Data de Início:</label>
        <input type="date" id="startDate" required><br>

        <label for="endDate">Data de Fim:</label>
        <input type="date" id="endDate" required><br>

        <button type="submit">Calcular Tarifa</button>
    </form>

    <p id="result"></p>

    <script>
        // Carregar o arquivo JSON das tarifas
        let rentalRates;

        fetch('tarifas.json')
            .then(response => response.json())
            .then(data => {
                rentalRates = data;
            })
            .catch(error => {
                console.error('Erro ao carregar o arquivo JSON:', error);
            });

        function formatDate(date) {
            const d = new Date(date);
            let day = '' + d.getDate();
            let month = '' + (d.getMonth() + 1);
            const year = d.getFullYear();

            if (day.length < 2) day = '0' + day;
            if (month.length < 2) month = '0' + month;
            return [year, month, day].join('-');
        }

        document.getElementById('rentalForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const numPeople = parseInt(document.getElementById('numPeople').value);
            const startDate = new Date(document.getElementById('startDate').value);
            const endDate = new Date(document.getElementById('endDate').value);

            if (startDate > endDate) {
                document.getElementById('result').innerText = "A data de fim deve ser maior que a data de início.";
                return;
            }

            let totalCost = 0;
            let currentDate = new Date(startDate);

            while (currentDate <= endDate) {
                const formattedDate = formatDate(currentDate);
                const dayRate = rentalRates.find(rate => rate.Data.split('T')[0] === formattedDate);

                if (!dayRate) {
                    document.getElementById('result').innerText = `Não há tarifas disponíveis para a data ${formattedDate}.`;
                    return;
                }

                let rate;

                if (numPeople <= 15) {
                    rate = dayRate['Até 15 pessoas'];
                } else if (numPeople <= 20) {
                    rate = dayRate['de 16 a 20 pessoas'];
                } else if (numPeople <= 30) {
                    rate = dayRate['21 a 30 pessoas'];
                } else if (numPeople <= 40) {
                    rate = dayRate['31 a 40 pessoas'];
                } else {
                    rate = dayRate['41 a 50 pessoas'];
                }

                // Multiplicar a tarifa pelo número de pessoas
                totalCost += rate * numPeople;
                currentDate.setDate(currentDate.getDate() + 1);
            }

            // Garantir que o valor mínimo seja de R$1500
            if (totalCost < 1500) {
                totalCost = 1500;
            }

            document.getElementById('result').innerText = `O valor total da estadia é R$ ${totalCost.toFixed(2)}`;
        });
    </script>
</body>
</html>
